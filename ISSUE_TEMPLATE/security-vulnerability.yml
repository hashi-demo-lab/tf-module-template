name: "üîí Security Vulnerability"
description: "Report a security vulnerability in a Terraform module"
title: "[SECURITY] "
labels: ["security", "vulnerability", "urgent", "needs-triage"]
assignees: []
body:
  - type: markdown
    attributes:
      value: |
        # Security Vulnerability Report
        
        **‚ö†Ô∏è IMPORTANT:** If this is a critical security vulnerability that could be exploited, please consider reporting it privately first through our security contact before creating this public issue.
        
        Thank you for helping keep our Terraform modules secure!

  - type: checkboxes
    id: severity_acknowledgment
    attributes:
      label: "üö® Severity Acknowledgment"
      description: "Please acknowledge the severity of this report"
      options:
        - label: "I understand this is a public issue and not suitable for critical vulnerabilities requiring private disclosure"
        - label: "This vulnerability has been responsibly disclosed through appropriate channels if critical"
    validations:
      required: true

  - type: input
    id: module_name
    attributes:
      label: "üì¶ Module Name"
      description: "Which Terraform module has the vulnerability?"
      placeholder: "e.g., terraform-aws-vpc"
    validations:
      required: true

  - type: input
    id: module_version
    attributes:
      label: "üè∑Ô∏è Module Version"
      description: "What version of the module is affected?"
      placeholder: "e.g., v1.2.3, or 'all versions'"
    validations:
      required: true

  - type: dropdown
    id: vulnerability_type
    attributes:
      label: "üéØ Vulnerability Type"
      description: "What type of security vulnerability is this?"
      options:
        - IAM/Access Control Issue
        - Network Security Misconfiguration
        - Encryption/Data Protection Issue
        - Secret/Credential Exposure
        - Resource Misconfiguration
        - Privilege Escalation
        - Injection Attack Vector
        - Denial of Service
        - Information Disclosure
        - Configuration Default Issue
        - Other
    validations:
      required: true

  - type: dropdown
    id: severity_level
    attributes:
      label: "‚ö° Severity Level"
      description: "How severe is this vulnerability?"
      options:
        - Critical - Immediate remote code execution or complete system compromise
        - High - Privilege escalation or significant data exposure
        - Medium - Limited data exposure or configuration weakness
        - Low - Minor security concern or hardening opportunity
    validations:
      required: true

  - type: textarea
    id: vulnerability_description
    attributes:
      label: "üîç Vulnerability Description"
      description: "Detailed description of the security vulnerability"
      placeholder: |
        Provide a clear description of:
        - What the vulnerability is
        - How it can be exploited
        - What systems/data are at risk
        - Any conditions required for exploitation
    validations:
      required: true

  - type: textarea
    id: affected_resources
    attributes:
      label: "üèóÔ∏è Affected Resources"
      description: "Which cloud resources are affected by this vulnerability?"
      placeholder: |
        Example:
        - aws_security_group: overly permissive rules
        - aws_s3_bucket: missing encryption configuration
        - aws_iam_role: excessive permissions
    validations:
      required: true

  - type: textarea
    id: exploitation_scenario
    attributes:
      label: "‚ö†Ô∏è Exploitation Scenario"
      description: "How could an attacker exploit this vulnerability?"
      placeholder: |
        Describe the attack scenario:
        - Attacker's entry point
        - Steps to exploit the vulnerability
        - What the attacker could achieve
        - Required attacker capabilities or access
    validations:
      required: true

  - type: textarea
    id: impact_assessment
    attributes:
      label: "üìä Impact Assessment"
      description: "What is the potential impact of this vulnerability?"
      placeholder: |
        Describe the potential impact:
        - Data confidentiality impact
        - Data integrity impact
        - System availability impact
        - Compliance implications
        - Business impact
    validations:
      required: true

  - type: textarea
    id: proof_of_concept
    attributes:
      label: "üß™ Proof of Concept"
      description: "Steps to reproduce or demonstrate the vulnerability"
      placeholder: |
        Provide steps to reproduce:
        1. Deploy the module with configuration...
        2. Attempt to access/exploit...
        3. Observe the security issue...
        
        Note: Please avoid including actual exploit code
    validations:
      required: true

  - type: textarea
    id: vulnerable_configuration
    attributes:
      label: "‚öôÔ∏è Vulnerable Configuration"
      description: "Show the Terraform configuration that creates the vulnerability"
      placeholder: |
        ```hcl
        module "vulnerable_example" {
          source = "..."
          
          # Configuration that creates the vulnerability
          setting_that_causes_issue = "value"
        }
        ```
      render: hcl
    validations:
      required: true

  - type: textarea
    id: recommended_fix
    attributes:
      label: "üîß Recommended Fix"
      description: "How should this vulnerability be fixed?"
      placeholder: |
        Describe the recommended solution:
        - Changes needed in the module code
        - Configuration changes required
        - Additional security controls needed
        - Validation that should be added
    validations:
      required: true

  - type: textarea
    id: secure_configuration
    attributes:
      label: "‚úÖ Secure Configuration Example"
      description: "Show how to configure the module securely"
      placeholder: |
        ```hcl
        module "secure_example" {
          source = "..."
          
          # Secure configuration
          secure_setting = "secure_value"
          encryption_enabled = true
          # etc.
        }
        ```
      render: hcl

  - type: textarea
    id: workaround
    attributes:
      label: "üîÑ Temporary Workaround"
      description: "Is there a temporary workaround until this is fixed?"
      placeholder: |
        Describe any temporary mitigation:
        - Configuration changes users can make now
        - Additional resources to deploy
        - External security controls
        - Monitoring/detection measures

  - type: checkboxes
    id: compliance_impact
    attributes:
      label: "üìã Compliance Impact"
      description: "Which compliance standards does this vulnerability affect?"
      options:
        - label: "SOC 2"
        - label: "PCI DSS"
        - label: "HIPAA"
        - label: "GDPR"
        - label: "FedRAMP"
        - label: "CIS Benchmarks"
        - label: "NIST Cybersecurity Framework"
        - label: "ISO 27001"
        - label: "Other compliance standards"

  - type: checkboxes
    id: discovery_method
    attributes:
      label: "üîç Discovery Method"
      description: "How was this vulnerability discovered?"
      options:
        - label: "Security scan (Checkov, TFSec, Terrascan)"
        - label: "Manual security review"
        - label: "Penetration testing"
        - label: "Production incident"
        - label: "Security research"
        - label: "Automated monitoring/alerting"
        - label: "Community report"
        - label: "Other"

  - type: textarea
    id: references
    attributes:
      label: "üìö References"
      description: "Relevant security references or documentation"
      placeholder: |
        - CVE numbers (if applicable)
        - Security advisories
        - Cloud provider security guides
        - Industry best practices documentation
        - Related vulnerability reports

  - type: textarea
    id: additional_context
    attributes:
      label: "üìÑ Additional Context"
      description: "Any other relevant information"
      placeholder: |
        - Environment where discovered
        - Affected versions range
        - Related security concerns
        - Dependencies that might be affected
        - Any other relevant details

  - type: checkboxes
    id: responsible_disclosure
    attributes:
      label: "ü§ù Responsible Disclosure"
      description: "Responsible disclosure checklist"
      options:
        - label: "I have not shared details of this vulnerability publicly before reporting"
        - label: "I have given the maintainers reasonable time to address critical issues"
        - label: "I understand this report may be made private if it poses immediate risk"
        - label: "I am willing to work with maintainers on coordinated disclosure"